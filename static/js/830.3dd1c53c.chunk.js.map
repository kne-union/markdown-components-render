{"version":3,"file":"static/js/830.3dd1c53c.chunk.js","mappings":"uhBAGA,MAiBMA,GAjBM,IAAIC,MAiBKC,QAfM,CACzBC,KAAM,SACNC,WAAY,CACV,gBAAiB,CACfD,KAAM,SACNC,WAAY,CACVD,KAAM,CAAEA,KAAM,UACdE,MAAO,CAAEF,KAAM,WAEjBG,SAAU,CAAC,OAAQ,WAGvBA,SAAU,CAAC,mBAKPC,EAAe,SAAUC,GAC7B,MAAMC,EAAeD,EAAGE,SAASC,MAAMC,MACvCJ,EAAGE,SAASC,MAAMC,MAAQ,SAAUC,EAAQC,EAAKC,EAASC,EAAKC,GAC7D,MAAMC,EAAQL,EAAOC,GACrB,GAA0B,QAAtBI,EAAMC,KAAKC,OACb,IACE,MAAMC,EAAWC,EAAAA,GAAAA,KAAUJ,EAAMK,SACjC,GAAIvB,EAASqB,GAAW,CACtB,MAAMG,EAAUC,SAASC,cAAc,OAGvC,OAFAF,EAAQG,aAAa,QAAS,mBAC9BH,EAAQI,QAAQC,WAAaC,KAAKC,UAAUV,GACrCG,EAAQQ,SACjB,CACF,CAAE,MAAOC,GAAI,CAEf,OAAOxB,EAAaI,EAAQC,EAAKC,EAASC,EAAKC,E,CAEnD,ECvCMiB,EAAmBA,CAAC7B,EAAO8B,KAC/B,GAAIC,MAAMC,QAAQhC,GAChB,OAAOA,EAAMiC,KAAIC,GACRL,EAAiBK,EAAMJ,KAGlC,GAAI9B,GAA8B,oBAArBA,EAAMmC,YAAoCC,OAAOC,KAAKrC,GAAOsC,OAAS,EAAG,CACpF,MAAMC,EAAW,CAAC,EAIlB,OAHAH,OAAOC,KAAKrC,GAAOwC,SAAQC,IACzBF,EAASE,GAAOZ,EAAiB7B,EAAMyC,GAAMX,EAAU,IAElDS,CACT,CACA,OAAIvC,GAA0B,kBAAVA,GAA0C,MAApBA,EAAM0C,OAAO,IAAcZ,EAAU9B,EAAM2C,UAAU,IACtFb,EAAU9B,EAAM2C,UAAU,IAG5B3C,CAAK,ECjBD4C,EAAe,CAAC,EAE7B,IAAAC,EAAeC,GACNV,OAAOW,OAAOH,EAAcE,G,8BCM/BE,EAA2BC,IAAuD,IAAtD,SAAEC,EAAW,GAAIC,OAAQC,GAAwBH,EAAPjD,E,2IAAKqD,CAAAJ,EAAAK,GAC/E,MAAM,cAAEC,EAAa,WAAE/B,EAAa,CAAC,EAAC,UAAEM,EAAY,CAAC,EAAC,QAAEpB,GAAY8C,IAAM,CAAC,EAAGZ,EAAc5C,GACtFmD,GAASM,EAAAA,EAAAA,IAAeP,IAC5B,MAAM,OAAEQ,EAAM,QAAEC,GAAYvB,OAAOW,OAAO,CAAC,EAAGrC,EAAS,CACrDgD,OAAQ,CAAC,EACTC,QAAS,KAGLxD,GAAKyD,EAAAA,EAAAA,GAASF,GACpBC,EAAQnB,SAAQqB,IACd,MAAMC,EAAa/B,MAAMC,QAAQ6B,GAAUA,EAAS,CAACA,GACrD1D,EAAG4D,OAAOD,EAAW,IAEvB3D,EAAG4D,IAAI7D,GAEP,MAAM8D,EAAO7D,EAAGgD,OAAOD,GACjBe,EAAO7C,SAASC,cAAc,OAEpC,OADA4C,EAAKC,UAAqC,oBAAlBX,EAA+BA,EAAcS,GAAQA,EACtE,GAAGG,MAAMC,KAAKH,EAAKf,UAAUjB,KAAI,CAACd,EAASkD,KAChD,GAA0B,oBAAtBlD,EAAQmD,WAAmCnD,EAAQI,QAAQC,WAAY,CACzE,MAAM+C,EAAiB9C,KAAK+C,MAAMrD,EAAQI,QAAQC,YAClD,IAAK+C,EAAe,iBAClB,OAAO,KAET,MAAM,KAAEzE,EAAI,MAAEE,GAAUuE,EAAe,iBACjCE,EAAcjD,EAAW1B,GAC/B,OAAK2E,EAGEC,IAAAA,cAACD,EAAWE,EAAA,GAAKvC,OAAOW,OAAO,CAAC,EAAGlB,EAAiB7B,EAAO8B,IAAW,CAAEW,IAAK4B,KAF3E,IAGX,CAEA,OAAOK,IAAAA,cAACE,EAAAA,SAAQ,CAACnC,IAAK4B,IAAQQ,EAAAA,EAAAA,IAAW1D,EAAQQ,WAAsB,GACvE,IAGEmD,GAASC,EAAAA,EAAAA,UAAQ,IACd5B,EAAOD,IACb,CAACA,EAAUC,IAEd,MAA4B,oBAAjBC,EACFA,EAAa0B,GAGfA,CAAM,C","sources":["../../src/markdown-it-components.js","../../src/compileVariables.js","../../src/preset.js","../../src/index.js"],"sourcesContent":["import yaml from 'js-yaml';\nimport Ajv from 'ajv';\n\nconst ajv = new Ajv();\n\nconst mdComponentsSchema = {\n  type: 'object',\n  properties: {\n    'md-components': {\n      type: 'object',\n      properties: {\n        type: { type: 'string' },\n        props: { type: 'object' }\n      },\n      required: ['type', 'props']\n    }\n  },\n  required: ['md-components']\n};\n\nconst validate = ajv.compile(mdComponentsSchema);\n\nconst mdComponents = function (md) {\n  const defaultFence = md.renderer.rules.fence;\n  md.renderer.rules.fence = function (tokens, idx, options, env, self) {\n    const token = tokens[idx];\n    if (token.info.trim() === 'yml') {\n      try {\n        const jsonData = yaml.load(token.content);\n        if (validate(jsonData)) {\n          const element = document.createElement('pre');\n          element.setAttribute('class', 'yaml-components');\n          element.dataset.components = JSON.stringify(jsonData);\n          return element.outerHTML;\n        }\n      } catch (e) {}\n    }\n    return defaultFence(tokens, idx, options, env, self);\n  };\n};\n\nexport default mdComponents;\n","const compileVariables = (props, variables) => {\n  if (Array.isArray(props)) {\n    return props.map(prop => {\n      return compileVariables(prop, variables);\n    });\n  }\n  if (props && props.toString() === '[object Object]' && Object.keys(props).length > 0) {\n    const newProps = {};\n    Object.keys(props).forEach(key => {\n      newProps[key] = compileVariables(props[key], variables);\n    });\n    return newProps;\n  }\n  if (props && typeof props === 'string' && props.charAt(0) === '$' && variables[props.substring(1)]) {\n    return variables[props.substring(1)];\n  }\n\n  return props;\n};\n\nexport default compileVariables;\n","export const globalParams = {};\n\nexport default newOptions => {\n  return Object.assign(globalParams, newOptions);\n};\n","import React, { useMemo, Fragment } from 'react';\nimport markdown from 'markdown-it';\nimport mdComponents from './markdown-it-components';\nimport compileVariables from './compileVariables';\nimport useRefCallback from '@kne/use-ref-callback';\nimport merge from 'lodash/merge';\nimport preset, { globalParams } from './preset';\nimport htmlParser from 'html-react-parser';\n\nconst MarkdownComponentsRender = ({ children = '', render: customRender, ...props }) => {\n  const { htmlTransform, components = {}, variables = {}, options } = merge({}, globalParams, props);\n  const render = useRefCallback(children => {\n    const { config, plugins } = Object.assign({}, options, {\n      config: {},\n      plugins: []\n    });\n\n    const md = markdown(config);\n    plugins.forEach(plugin => {\n      const pluginArgs = Array.isArray(plugin) ? plugin : [plugin];\n      md.use(...pluginArgs);\n    });\n    md.use(mdComponents);\n\n    const html = md.render(children);\n    const root = document.createElement('div');\n    root.innerHTML = typeof htmlTransform === 'function' ? htmlTransform(html) : html;\n    return [].slice.call(root.children).map((element, index) => {\n      if (element.className === 'yaml-components' && element.dataset.components) {\n        const componentsData = JSON.parse(element.dataset.components);\n        if (!componentsData['md-components']) {\n          return null;\n        }\n        const { type, props } = componentsData['md-components'];\n        const MdComponent = components[type];\n        if (!MdComponent) {\n          return null;\n        }\n        return <MdComponent {...Object.assign({}, compileVariables(props, variables))} key={index} />;\n      }\n\n      return <Fragment key={index}>{htmlParser(element.outerHTML)}</Fragment>;\n    });\n  });\n\n  const result = useMemo(() => {\n    return render(children);\n  }, [children, render]);\n\n  if (typeof customRender === 'function') {\n    return customRender(result);\n  }\n\n  return result;\n};\n\nexport default MarkdownComponentsRender;\nexport { preset };\n"],"names":["validate","Ajv","compile","type","properties","props","required","mdComponents","md","defaultFence","renderer","rules","fence","tokens","idx","options","env","self","token","info","trim","jsonData","yaml","content","element","document","createElement","setAttribute","dataset","components","JSON","stringify","outerHTML","e","compileVariables","variables","Array","isArray","map","prop","toString","Object","keys","length","newProps","forEach","key","charAt","substring","globalParams","preset","newOptions","assign","MarkdownComponentsRender","_ref","children","render","customRender","_objectWithoutPropertiesLoose","_excluded","htmlTransform","merge","useRefCallback","config","plugins","markdown","plugin","pluginArgs","use","html","root","innerHTML","slice","call","index","className","componentsData","parse","MdComponent","React","_extends","Fragment","htmlParser","result","useMemo"],"sourceRoot":""}